### 域名

[browser]()

    http://www.apple.com

我相信你一定在浏览器输入过网址，这里的www.apple.com就是苹果公司的域名。当输入完网址然后点击回车之后，浏览器会转向相应的网站。在上面的例子就会跳转到苹果。如果你有足够的好奇心的话，你会想知道这中间发生了什么。

这里我们需要知道一些基础知识。当一台计算机接入互联网（注意这里指的互联网而不是局域网），它需要获得一个ip地址，例如31.41.59.26（就像国家代码+电话号码一样，是全球唯一的）。但是如果每次你要访问一个网站你都要背下它的ip的话，你一定会崩溃，所以互联网的智者就想到使用别名来指向ip，也就是说www.apple.com会被翻译成苹果一台计算机的ip。那么计算机怎么知道这个域名对应的是哪个ip呢？在一开始，互联网只是一些geek和nerd在用，一共才三百多台机器，所以大家都维护着一个文件，专门记录着这个域名对应哪个ip，文件的内容就像

www.apple.com 119.145.144.223

这样计算机每次看到www.apple.com就会到这个文件（传说中的hosts文件）里面找对应的ip，然后找到这个地址的物理主机，获取资源（图片，文字）。这个时候域名就是ip的别名。

随着时间发展，现在每个小时都有新的域名被注册，新的主机加入互联网。让每台电脑每小时都更新这个hosts文件显然不现实，所以现在的计算机都是使用多重方式来获取域名的ip：

### 先查询浏览器有没有保留缓存
如果你之前访问过这个网站，那么浏览器会保存对应的ip地址，这样就能减少查询ip的时间

### 查询本地的hosts文件
如果hosts文件有对应的内容，例如上面的
www.apple.com 119.145.144.223
那么计算机就会直接使用这个ip

###DNS服务器查询
全球一共有13组共632台根域名服务器，分布在世界各地，每台下面又有N台子域名服务器。当计算机在前两个方法都没有找到对应的ip，会先查询最近的子域名服务器，获取到ip地址，子域名服务器会定时从根域名服务器中更新内容。那么是不是破坏这13组根域名服务器就能破坏互联网呢？很明显，是的。

那么如果在浏览器直接输入ip地址，是不是就能访问到apple.com呢。很遗憾地说，在现在的互联网，大部分情况下是不可以的。

互联网最早刚开始建立的时候，物理主机和域名是一一对应的关系，也就是说一个网站背后就是一台专门为它服务的物理主机。一台物理主机也对应着一个网站。一开始建立一个网站你需要买一台计算机，然后向运营商申请ip地址才能让全世界的人访问到。到后来，出现了主机服务商，它们帮我们做好了大部分的工作，包括购买硬件，申请ip。我们只需要向它申请一台主机使用就行。这样要建立一个网站的费用就更低了。我们申请的主机其实是主机商提供给我们的虚拟化主机，很多情况下它不是一台物理主机，而是由一台强大的物理主机虚拟化出来的一台虚拟主机。当我们选好配置之后，例如我们选择

    1核 1G
    50G系统盘(云硬盘)
    1Mbps带宽

那么主机商就会从这台物理主机中新建一个虚拟主机分配给我们使用，它会分配一个公网ip给你，然后你可以使用nginx这类的反向代理根据传过来的域名然后分配到虚拟主机的不同端口。所以一个ip，一个虚拟主机其实可以为多个域名服务。
